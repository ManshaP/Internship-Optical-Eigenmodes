(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     32058,        662]
NotebookOptionsPosition[     31470,        637]
NotebookOutlinePosition[     31814,        652]
CellTagsIndexPosition[     31771,        649]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"n1", "=", "1.500`"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n2", "=", "1.500`"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n3", "=", "1.505`"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w1", "=", "3.0`"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w2", "=", "3.5`"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w3", "=", 
   RowBox[{"w1", "+", "w2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k1", "=", 
   RowBox[{"n1", " ", 
    RowBox[{"w1", "/", "c"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k2", "=", 
   RowBox[{"n2", " ", 
    RowBox[{"w2", "/", "c"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k3", "=", 
   RowBox[{"n3", " ", 
    RowBox[{"w3", "/", "c"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X2", "=", "0.01`"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[CapitalDelta]k", "=", " ", 
  RowBox[{"k3", "-", "k2", "-", "k1"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p1a", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p1b", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"p1c", "=", "4"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p2a", "=", "6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p2b", "=", "7"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p2c", "=", "8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xmax", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zmax", "=", "500"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"equations", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"E3", "[", 
          RowBox[{"x", ",", "z"}], "]"}], ",", "z"}], "]"}], "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "I"}], " ", 
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{"2", " ", "k3"}], ")"}]}], " ", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"E3", "[", 
            RowBox[{"x", ",", "z"}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"x", ",", "2"}], "}"}]}], "]"}]}], "-", " ", 
        RowBox[{"I", " ", 
         RowBox[{"w3", "/", 
          RowBox[{"(", 
           RowBox[{"2", " ", "c", " ", "n3"}], ")"}]}], " ", "X2", "  ", 
         RowBox[{"E1", "[", 
          RowBox[{"x", ",", "z"}], "]"}], "*", 
         RowBox[{"E2", "[", 
          RowBox[{"x", ",", "z"}], "]"}], " ", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", " ", "\[CapitalDelta]k", " ", "z"}], "]"}]}]}]}], ",", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"E2", "[", 
          RowBox[{"x", ",", "z"}], "]"}], ",", "z"}], "]"}], "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "I"}], " ", 
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{"2", " ", "k2"}], ")"}]}], " ", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"E2", "[", 
            RowBox[{"x", ",", "z"}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"x", ",", "2"}], "}"}]}], "]"}]}], "-", " ", 
        RowBox[{"I", " ", 
         RowBox[{"w2", "/", 
          RowBox[{"(", 
           RowBox[{"2", " ", "c", " ", "n2"}], ")"}]}], " ", "X2", " ", 
         RowBox[{"E3", "[", 
          RowBox[{"x", ",", "z"}], "]"}], "*", 
         RowBox[{"Conjugate", "[", 
          RowBox[{"E1", "[", 
           RowBox[{"x", ",", "z"}], "]"}], "]"}], " ", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "I"}], " ", "\[CapitalDelta]k", " ", "z"}], 
          "]"}]}]}]}], ",", " ", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"E1", "[", 
          RowBox[{"x", ",", "z"}], "]"}], ",", "z"}], "]"}], "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "I"}], " ", 
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{"2", " ", "k1"}], ")"}]}], " ", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"E1", "[", 
            RowBox[{"x", ",", "z"}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"x", ",", "2"}], "}"}]}], "]"}]}], "-", " ", 
        RowBox[{"I", " ", 
         RowBox[{"w1", "/", 
          RowBox[{"(", 
           RowBox[{"2", " ", "c", " ", "n1"}], ")"}]}], " ", "X2", " ", 
         RowBox[{"E3", "[", 
          RowBox[{"x", ",", "z"}], "]"}], "*", 
         RowBox[{"Conjugate", "[", 
          RowBox[{"E2", "[", 
           RowBox[{"x", ",", "z"}], "]"}], "]"}], " ", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "I"}], " ", "\[CapitalDelta]k", " ", "z"}], 
          "]"}]}]}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"initials", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"E1", "[", 
       RowBox[{"x", ",", "0"}], "]"}], "\[Equal]", 
      RowBox[{"Exp", "[", 
       RowBox[{"2", " ", "I", " ", "Pi", " ", "p1", " ", 
        RowBox[{"x", "/", "xmax"}]}], "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"E2", "[", 
       RowBox[{"x", ",", "0"}], "]"}], "\[Equal]", 
      RowBox[{"Exp", "[", 
       RowBox[{"2", " ", "I", " ", "Pi", " ", "p2", " ", 
        RowBox[{"x", "/", "xmax"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"E3", "[", 
       RowBox[{"x", ",", "0"}], "]"}], "\[Equal]", "0"}], ",", 
     "\[IndentingNewLine]", " ", 
     RowBox[{
      RowBox[{"E1", "[", 
       RowBox[{"0", ",", "z"}], "]"}], "==", 
      RowBox[{"E1", "[", 
       RowBox[{"xmax", ",", "z"}], "]"}]}], ",", "  ", 
     RowBox[{
      RowBox[{"E3", "[", 
       RowBox[{"0", ",", "z"}], "]"}], "==", 
      RowBox[{"E3", "[", 
       RowBox[{"xmax", ",", "z"}], "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"E2", "[", 
       RowBox[{"0", ",", "z"}], "]"}], "==", 
      RowBox[{"E2", "[", 
       RowBox[{"xmax", ",", "z"}], "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gaussinitials", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"E1", "[", 
       RowBox[{"x", ",", "0"}], "]"}], "\[Equal]", 
      RowBox[{
       RowBox[{"0.158", " ", 
        RowBox[{"Exp", "[", 
         RowBox[{"2", " ", "I", " ", "Pi", " ", "p1a", " ", 
          RowBox[{"x", "/", "xmax"}]}], "]"}]}], "+", 
       RowBox[{"0.682", " ", 
        RowBox[{"Exp", "[", 
         RowBox[{"2", " ", "I", " ", "Pi", " ", "p1b", " ", 
          RowBox[{"x", "/", "xmax"}]}], "]"}]}], "+", 
       RowBox[{"0.158", 
        RowBox[{"Exp", "[", 
         RowBox[{"2", " ", "I", " ", "Pi", " ", "p1c", " ", 
          RowBox[{"x", "/", "xmax"}]}], "]"}]}]}]}], ",", " ", 
     RowBox[{
      RowBox[{"E2", "[", 
       RowBox[{"x", ",", "0"}], "]"}], "\[Equal]", 
      RowBox[{
       RowBox[{"0.158", " ", 
        RowBox[{"Exp", "[", 
         RowBox[{"2", " ", "I", " ", "Pi", " ", "p2a", " ", 
          RowBox[{"x", "/", "xmax"}]}], "]"}]}], "+", 
       RowBox[{"0.682", " ", 
        RowBox[{"Exp", "[", 
         RowBox[{"2", " ", "I", " ", "Pi", " ", "p2b", " ", 
          RowBox[{"x", "/", "xmax"}]}], "]"}]}], "+", 
       RowBox[{"0.158", 
        RowBox[{"Exp", "[", 
         RowBox[{"2", " ", "I", " ", "Pi", " ", "p2c", " ", 
          RowBox[{"x", "/", "xmax"}]}], "]"}]}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"E3", "[", 
       RowBox[{"x", ",", "0"}], "]"}], "\[Equal]", "0"}], ",", 
     "\[IndentingNewLine]", " ", 
     RowBox[{
      RowBox[{"E1", "[", 
       RowBox[{"0", ",", "z"}], "]"}], "==", 
      RowBox[{"E1", "[", 
       RowBox[{"xmax", ",", "z"}], "]"}]}], ",", "  ", 
     RowBox[{
      RowBox[{"E3", "[", 
       RowBox[{"0", ",", "z"}], "]"}], "==", 
      RowBox[{"E3", "[", 
       RowBox[{"xmax", ",", "z"}], "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"E2", "[", 
       RowBox[{"0", ",", "z"}], "]"}], "==", 
      RowBox[{"E2", "[", 
       RowBox[{"xmax", ",", "z"}], "]"}]}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.71136800860521*^9, 3.7113680871737037`*^9}, {
   3.711368291412386*^9, 3.7113684531146345`*^9}, {3.711368522498603*^9, 
   3.71136852489774*^9}, {3.711368739746029*^9, 3.7113687470174446`*^9}, {
   3.711368965374934*^9, 3.7113689673590474`*^9}, {3.71136901216061*^9, 
   3.711369022911225*^9}, {3.711431792456173*^9, 3.7114318243399973`*^9}, {
   3.7114327553652487`*^9, 3.7114328549399443`*^9}, {3.7114345239774075`*^9, 
   3.7114345314638357`*^9}, {3.711434929662611*^9, 3.7114349317337294`*^9}, {
   3.7114351259968405`*^9, 3.7114351262438555`*^9}, {3.711435173172539*^9, 
   3.711435244723632*^9}, {3.7114353187638664`*^9, 3.711435328386417*^9}, {
   3.7114353624193635`*^9, 3.7114353653385305`*^9}, {3.7114356035611563`*^9, 
   3.711435639192194*^9}, {3.7114357314324703`*^9, 3.7114357637033157`*^9}, {
   3.7114358069037867`*^9, 3.711435909751669*^9}, {3.711436099165503*^9, 
   3.711436099693533*^9}, {3.711436592241705*^9, 3.711436631416946*^9}, {
   3.7114437044994645`*^9, 3.711443757650504*^9}, {3.71144493788301*^9, 
   3.7114450311853466`*^9}, {3.711445079218094*^9, 3.7114450796091166`*^9}, {
   3.711445110569887*^9, 3.7114451248727055`*^9}, {3.711702222432429*^9, 
   3.7117023434473505`*^9}, {3.711702497704173*^9, 3.7117024980541935`*^9}, {
   3.7117025514302464`*^9, 3.711702621325244*^9}, {3.7117027136615257`*^9, 
   3.711702714020546*^9}, {3.71170279084494*^9, 3.711702836075527*^9}, {
   3.7117028948518887`*^9, 3.7117029043074293`*^9}, {3.7117029352121973`*^9, 
   3.71170296636998*^9}, {3.7117030043071494`*^9, 3.7117030806815176`*^9}, {
   3.7117031147384653`*^9, 3.7117031304183626`*^9}, {3.7117038062420177`*^9, 
   3.7117038248240805`*^9}, {3.7117039675502434`*^9, 
   3.7117039721805086`*^9}, {3.7117045267932305`*^9, 3.711704542232114*^9}, {
   3.711708200663364*^9, 3.7117082013584037`*^9}, {3.7117088511485696`*^9, 
   3.7117088512085733`*^9}, {3.711709057344363*^9, 3.7117090674479413`*^9}, 
   3.711709131007577*^9, {3.711709198601443*^9, 3.7117092133912888`*^9}, {
   3.7117092935188713`*^9, 3.7117093322540874`*^9}, {3.711709367006075*^9, 
   3.7117093790617647`*^9}, {3.711709668933344*^9, 3.7117096734035997`*^9}, {
   3.7117098555390177`*^9, 3.7117098594012384`*^9}, {3.711710250855628*^9, 
   3.7117102625352964`*^9}, {3.7117119584372964`*^9, 3.7117119586833105`*^9}, 
   3.711711999164626*^9, {3.7117129642821054`*^9, 3.7117129701414404`*^9}, {
   3.711713433998972*^9, 3.7117134492138414`*^9}, {3.7117135076381836`*^9, 
   3.711713521934001*^9}, 3.7117138697798967`*^9, 3.7117141034342613`*^9, 
   3.7117141547381954`*^9, 3.711714241761173*^9, {3.7117146738138847`*^9, 
   3.711714676965065*^9}, {3.711714890197261*^9, 3.711714895684575*^9}, {
   3.711715087124525*^9, 3.711715087371539*^9}, 3.711715173089442*^9, 
   3.7117157715996747`*^9, {3.7117158668301215`*^9, 3.711715867037133*^9}, {
   3.711715951652973*^9, 3.711715953780095*^9}, {3.7117160173497305`*^9, 
   3.7117160458443604`*^9}, {3.7117163633795223`*^9, 3.711716363545532*^9}, {
   3.711773287376684*^9, 3.711773287498691*^9}, {3.7117734165450726`*^9, 
   3.711773441840519*^9}, {3.7117735180408773`*^9, 3.711773534504819*^9}, {
   3.711773573369042*^9, 3.711773576408216*^9}, 3.711773613912361*^9, {
   3.711773657415849*^9, 3.7117736576008596`*^9}, {3.711773832175845*^9, 
   3.711773879343543*^9}, {3.7117750758789806`*^9, 3.711775090093794*^9}, {
   3.711777359894619*^9, 3.711777443981428*^9}, 3.711777482277619*^9, 
   3.711777595557098*^9, 3.7117777441715984`*^9, 3.711778103786167*^9, 
   3.711778795956757*^9, {3.711779046667097*^9, 3.7117790480501757`*^9}, {
   3.711779192097415*^9, 3.711779193457493*^9}, 3.711779365960359*^9, 
   3.711779399768293*^9, {3.711779596727558*^9, 3.711779598133639*^9}, {
   3.7117798371573105`*^9, 3.7117798379483557`*^9}, {3.711779911444559*^9, 
   3.711779938764122*^9}, {3.71177999274821*^9, 3.7117799956033726`*^9}, {
   3.711781274051496*^9, 3.711781276170617*^9}, 3.7117813712020526`*^9, 
   3.711781493978075*^9, {3.7117816078645887`*^9, 3.7117816080636005`*^9}, {
   3.711781748328623*^9, 3.7117817529668884`*^9}, {3.7117819786147947`*^9, 
   3.7117819787808037`*^9}, 3.7117820654537616`*^9, 3.7117821186208024`*^9, 
   3.711782295267906*^9, {3.711782332428032*^9, 3.7117823394184313`*^9}, {
   3.711782937560643*^9, 3.7117829378956623`*^9}, {3.711783023663568*^9, 
   3.711783023830578*^9}, {3.7117830831339693`*^9, 3.7117831115815964`*^9}, {
   3.711783157590228*^9, 3.7117831583332705`*^9}, 3.7117832590370307`*^9, 
   3.711783318084408*^9, 3.7117833809800053`*^9, {3.711783498939752*^9, 
   3.7117835077552567`*^9}, 3.7117835386910257`*^9, {3.711783682458249*^9, 
   3.7117836851294017`*^9}, 3.7117843509254827`*^9, {3.711786612733851*^9, 
   3.711786617317113*^9}, {3.711788156431666*^9, 3.7117881588628054`*^9}, {
   3.711795159542221*^9, 3.7117951600212483`*^9}, 3.711797028697131*^9, 
   3.711798396727378*^9, 3.7117984676864357`*^9, 3.7117985396385517`*^9, 
   3.71179957148057*^9, {3.7117996182152424`*^9, 3.711799618766274*^9}, {
   3.711799801301715*^9, 3.711799864875351*^9}, {3.7117999640030203`*^9, 
   3.711800000491108*^9}, 3.7118000508109856`*^9, {3.7118003630098424`*^9, 
   3.711800366913066*^9}, 3.7118630211246448`*^9, {3.711863372651751*^9, 
   3.7118633788331046`*^9}, {3.7118634997310195`*^9, 
   3.7118635270325813`*^9}, {3.711863593184365*^9, 3.7118635964085493`*^9}, {
   3.7118636708088045`*^9, 3.711863676551133*^9}, {3.7118637075679073`*^9, 
   3.711863707774919*^9}, {3.711864644474495*^9, 3.71186467409719*^9}, {
   3.7118679708337517`*^9, 3.711867973384898*^9}, {3.711877907299085*^9, 
   3.7118779142434826`*^9}, {3.7118787187264967`*^9, 3.7118787204055924`*^9}, 
   3.7118788650938683`*^9, 3.7118789339558067`*^9, 3.7118791314031*^9, 
   3.7118792676748943`*^9, 3.711879310362336*^9, 3.7118793611062384`*^9, {
   3.7118794094890056`*^9, 3.7118794147293053`*^9}, 3.7118795335851035`*^9, 
   3.7118800962112837`*^9, {3.7118802250596533`*^9, 3.711880227250779*^9}, 
   3.711880337363077*^9, 3.7118807258802986`*^9, {3.7118807689347615`*^9, 
   3.711880771037882*^9}, {3.711881543363056*^9, 3.7118815452741656`*^9}, 
   3.711883239750084*^9, {3.7120583727885036`*^9, 3.7120583751166368`*^9}, {
   3.712058882178639*^9, 3.7120588886410084`*^9}, 3.7120596512856293`*^9, 
   3.712061734717795*^9, 3.7120618164464693`*^9, 3.712061963187863*^9, 
   3.7120620375711174`*^9, 3.712294360298427*^9, {3.7122949829980435`*^9, 
   3.7122949851831684`*^9}, {3.7123041406778326`*^9, 3.7123041759578505`*^9}, 
   3.7123042346692085`*^9, 3.7123043984525766`*^9, {3.7123045077308273`*^9, 
   3.712304525769859*^9}, {3.7123046547852383`*^9, 3.7123046571213717`*^9}, {
   3.712466228555813*^9, 3.7124662768985777`*^9}, 3.712466355645082*^9, 
   3.7124663975704803`*^9, {3.7124664636502595`*^9, 3.712466500865388*^9}, {
   3.7124665374984837`*^9, 3.7124665438748484`*^9}, {3.712467127015202*^9, 
   3.7124671352776747`*^9}, {3.712467449796664*^9, 3.7124674774832478`*^9}, {
   3.712467648107007*^9, 3.7124676515142016`*^9}, 3.712467769633958*^9, {
   3.712467856345917*^9, 3.7124678673125443`*^9}, {3.7124680666559467`*^9, 
   3.7124680851830063`*^9}, {3.7124681284474807`*^9, 3.7124681827735877`*^9}, 
   3.7124690582556624`*^9, {3.712469824730502*^9, 3.7124698259535723`*^9}, {
   3.712469882226791*^9, 3.7124698825778112`*^9}, {3.7124704929497223`*^9, 
   3.71247050234126*^9}, {3.7124705907803183`*^9, 3.7124705951405673`*^9}, 
   3.7124706897729797`*^9, 3.7124707313563585`*^9, 3.7124711593688393`*^9, {
   3.712471251968136*^9, 3.712471258407504*^9}, {3.7124712998638754`*^9, 
   3.7124713277274685`*^9}, 3.7126559593876123`*^9, {3.7129871179039073`*^9, 
   3.7129872279992046`*^9}, {3.712987258358941*^9, 3.712987346597988*^9}, 
   3.712987463932699*^9, {3.7129924437085257`*^9, 3.7129924440195436`*^9}, 
   3.7130721674959955`*^9}],

Cell[BoxData["0.03249999999999886`"], "Output",
 CellChangeTimes->{
  3.7113684702446136`*^9, {3.7113685025784636`*^9, 3.711368525408769*^9}, {
   3.711368752585763*^9, 3.711368764217428*^9}, {3.711368831397271*^9, 
   3.711368835892528*^9}, 3.711369001550003*^9, {3.711431797764477*^9, 
   3.711431825513064*^9}, 3.7114322795980363`*^9, 3.7114327564763117`*^9, 
   3.7114328566660423`*^9, 3.7114345343219995`*^9, {3.711434799111144*^9, 
   3.7114348154270773`*^9}, {3.711434933430827*^9, 3.7114349414212837`*^9}, {
   3.7114351271199055`*^9, 3.711435131134135*^9}, 3.7114353289234476`*^9, {
   3.7114353662005796`*^9, 3.71143536881973*^9}, 3.7114356106695623`*^9, 
   3.7114356432384253`*^9, {3.711435734850665*^9, 3.711435766154456*^9}, {
   3.711435797682259*^9, 3.71143588267212*^9}, 3.711435914055915*^9, 
   3.7114361025076942`*^9, {3.7114365785559225`*^9, 3.711436634080098*^9}, {
   3.711443732428062*^9, 3.71144376037366*^9}, {3.7114449426142807`*^9, 
   3.7114450343715286`*^9}, 3.7114450822132654`*^9, {3.7114451133110437`*^9, 
   3.7114451271888375`*^9}, {3.7117024886646566`*^9, 3.71170251862237*^9}, 
   3.7117026234603662`*^9, 3.7117026605624886`*^9, 3.7117027182417874`*^9, {
   3.7117028040746965`*^9, 3.711702860578929*^9}, 3.7117029059605246`*^9, 
   3.711702936095248*^9, 3.7117029789066963`*^9, {3.7117030548740416`*^9, 
   3.711703088450962*^9}, 3.711703136000682*^9, 3.711703840257963*^9, 
   3.711703975193681*^9, 3.7117043756045833`*^9, 3.711704592753003*^9, 
   3.7117050868172617`*^9, 3.7117082072827425`*^9, 3.711708883812438*^9, {
   3.7117090702361007`*^9, 3.7117090792806177`*^9}, {3.7117091329076853`*^9, 
   3.7117091417581916`*^9}, {3.7117093733234367`*^9, 3.7117093935905952`*^9}, 
   3.711709457029224*^9, 3.7117096207085857`*^9, 3.7117096792559347`*^9, 
   3.7117098609073243`*^9, 3.7117100716753798`*^9, 3.7117102683116264`*^9, 
   3.711711097492053*^9, 3.7117111656439514`*^9, 3.7117112332778196`*^9, 
   3.711711962568533*^9, 3.7117120011957417`*^9, 3.7117129797149878`*^9, 
   3.7117130623577147`*^9, 3.7117132655833387`*^9, 3.711713323701663*^9, 
   3.711713451668982*^9, {3.7117135122964497`*^9, 3.7117135240931244`*^9}, 
   3.7117138721550326`*^9, 3.7117140097569027`*^9, 3.7117141058543997`*^9, 
   3.7117141570533276`*^9, 3.7117142446053357`*^9, {3.71171468334743*^9, 
   3.7117147350933895`*^9}, 3.7117149244792223`*^9, 3.7117150898976836`*^9, {
   3.7117151440777826`*^9, 3.7117151651689887`*^9}, 3.711715737213708*^9, 
   3.71171577449184*^9, 3.7117158693982687`*^9, {3.711715928226633*^9, 
   3.711715957296296*^9}, {3.711716024345131*^9, 3.7117160490925465`*^9}, 
   3.711716313380663*^9, 3.711716365631651*^9, 3.711773292894*^9, 
   3.7117733264069166`*^9, {3.711773420718311*^9, 3.7117734446826816`*^9}, 
   3.711773541478218*^9, 3.7117735817645226`*^9, 3.7117736166675186`*^9, 
   3.711773660102003*^9, 3.7117738524640055`*^9, 3.7117738838848023`*^9, 
   3.711773951622677*^9, 3.711774862079752*^9, 3.711774992776228*^9, 
   3.7117750969561863`*^9, 3.7117761393868103`*^9, {3.7117773716052885`*^9, 
   3.7117773990268574`*^9}, 3.7117774464795713`*^9, 3.7117774843557377`*^9, 
   3.7117775978012266`*^9, 3.711777697769944*^9, 3.7117777486498547`*^9, 
   3.711778106843342*^9, 3.711778798336893*^9, 3.7117790501932983`*^9, 
   3.711779196325657*^9, 3.7117792271964226`*^9, 3.711779369406556*^9, 
   3.7117794025224504`*^9, 3.711779600485773*^9, 3.7117798406895123`*^9, {
   3.7117799151967735`*^9, 3.7117799408302402`*^9}, 3.7117799986105447`*^9, 
   3.7117812794308033`*^9, {3.711781373054158*^9, 3.711781392538273*^9}, 
   3.7117814966782293`*^9, 3.7117816107197523`*^9, 3.7117817553290234`*^9, 
   3.7117819811519394`*^9, 3.7117820679979067`*^9, 3.711782120633918*^9, 
   3.7117822977880507`*^9, 3.7117823545272956`*^9, 3.711782940914835*^9, {
   3.711783025905696*^9, 3.711783038285404*^9}, {3.7117830860361357`*^9, 
   3.7117831140147357`*^9}, 3.7117831606014004`*^9, 3.711783261427167*^9, 
   3.711783320503546*^9, 3.7117833837981663`*^9, 3.7117835098273745`*^9, 
   3.71178354121017*^9, 3.711783687419533*^9, 3.7117843536596394`*^9, 
   3.7117866204552927`*^9, 3.711788161230941*^9, {3.7117889131319466`*^9, 
   3.711788937687351*^9}, 3.711790296221055*^9, {3.7117935118999815`*^9, 
   3.7117935237606597`*^9}, 3.711793871217533*^9, 3.7117951627904067`*^9, 
   3.7117970307572484`*^9, 3.71179840638693*^9, 3.7117984718866763`*^9, 
   3.711798542269702*^9, 3.711799574926767*^9, 3.7117996217674456`*^9, {
   3.711799681650871*^9, 3.7117996926414995`*^9}, 3.711799840833976*^9, 
   3.7118000034932795`*^9, 3.711800053034113*^9, 3.711800369147194*^9, 
   3.7118630289220905`*^9, 3.7118633819962854`*^9, 3.7118635300037513`*^9, 
   3.711863598814687*^9, 3.7118636791592827`*^9, 3.7118637101610556`*^9, {
   3.711864646706623*^9, 3.711864677549387*^9}, 3.7118647624112406`*^9, 
   3.7118648206465716`*^9, 3.7118650198369646`*^9, 3.7118652321311073`*^9, 
   3.711865601166215*^9, 3.711866072549176*^9, 3.7118779149755244`*^9, 
   3.7118787235047693`*^9, 3.7118788676470137`*^9, 3.7118789589772377`*^9, 
   3.7118791336842303`*^9, 3.7118792694799976`*^9, 3.711879312455456*^9, 
   3.71187936341337*^9, 3.711879417118442*^9, 3.711879536932295*^9, 
   3.711880107546932*^9, 3.711880230097942*^9, 3.711880339848219*^9, 
   3.711880728400443*^9, 3.7118807794243617`*^9, 3.7118815471572733`*^9, 
   3.711883241965211*^9, 3.711884602650038*^9, 3.7120583778427925`*^9, 
   3.71205889320927*^9, 3.7120596547838297`*^9, 3.71206173917705*^9, 
   3.7120618190726194`*^9, 3.7120618669603586`*^9, 3.712061968298155*^9, 
   3.712062047565689*^9, 3.7122942474749737`*^9, 3.712294364438664*^9, 
   3.712294987601307*^9, 3.7123042371783524`*^9, 3.7123044045189238`*^9, 
   3.7123045357644305`*^9, 3.712304667596971*^9, 3.7124663102964883`*^9, 
   3.712466358373238*^9, 3.7124664048488965`*^9, 3.712466466869444*^9, 
   3.7124665041405754`*^9, 3.712466546774014*^9, 3.7124671390168886`*^9, 
   3.7124674813284674`*^9, 3.712467654047346*^9, 3.7124677731701603`*^9, 
   3.7124678717487984`*^9, {3.7124681628294473`*^9, 3.712468189854993*^9}, 
   3.712469074387585*^9, 3.71246988535697*^9, 3.712470507633562*^9, 
   3.712470606779233*^9, 3.7124706921211147`*^9, 3.7124707358136134`*^9, 
   3.7124711663522387`*^9, 3.7124712671010013`*^9, {3.7124713113035297`*^9, 
   3.7124713320077133`*^9}, 3.712655923916583*^9, 3.7126559615597363`*^9, 
   3.7129873500881877`*^9, 3.712987469961044*^9, 3.712992446037659*^9, 
   3.7130721705991726`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"s", "=", 
    RowBox[{
     RowBox[{"NDSolve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"equations", ",", " ", "gaussinitials"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"E1", ",", " ", "E2", ",", " ", "E3"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"x", ",", " ", "0", ",", "xmax"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"z", ",", "0", ",", "zmax"}], "}"}], ",", " ", 
       RowBox[{"MaxStepSize", "\[Rule]", "0.08"}]}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.711368547322023*^9, 3.7113686116407013`*^9}, {
   3.711368700704796*^9, 3.71136871284049*^9}, {3.711368971463282*^9, 
   3.711368976366563*^9}, 3.711431802700759*^9, {3.7114325179926715`*^9, 
   3.711432524797061*^9}, {3.7114346092482843`*^9, 3.7114346140795608`*^9}, {
   3.711434788814555*^9, 3.711434792990794*^9}, 3.711436571306508*^9, {
   3.711702327039412*^9, 3.711702333222766*^9}, {3.711702363422493*^9, 
   3.711702409654137*^9}, 3.7117029185312433`*^9, 3.7117038280762663`*^9, {
   3.7117043940246367`*^9, 3.7117043945116644`*^9}, {3.711709025040516*^9, 
   3.7117090316978965`*^9}, {3.711709451629915*^9, 3.7117094517409215`*^9}, {
   3.7117096129871445`*^9, 3.7117096131631546`*^9}, {3.7117110816261454`*^9, 
   3.711711081953164*^9}, 3.7117111561454077`*^9, {3.7117112295526066`*^9, 
   3.711711230016633*^9}, {3.711712010859295*^9, 3.7117120110343046`*^9}, {
   3.711713040958491*^9, 3.7117130412585077`*^9}, {3.7117132710976543`*^9, 
   3.711713318286353*^9}, {3.711714680917291*^9, 3.711714732076217*^9}, 
   3.7117149123475285`*^9, {3.711715141217619*^9, 3.711715141649644*^9}, 
   3.7117157339715223`*^9, {3.7117159225003057`*^9, 3.711715939644286*^9}, 
   3.7117792247852845`*^9, 3.7117830356382527`*^9, {3.711789061296421*^9, 
   3.711789082758649*^9}, {3.7117893634457035`*^9, 3.7117893703810997`*^9}, {
   3.711790264960267*^9, 3.7117902789750686`*^9}, 3.7117903218075185`*^9, 
   3.711793499585277*^9, {3.711793618376072*^9, 3.711793624527423*^9}, {
   3.7117943024842005`*^9, 3.7117943030672336`*^9}, {3.711799678469689*^9, 
   3.7117996786366987`*^9}, {3.711864566305024*^9, 3.7118645724403753`*^9}, {
   3.7118646531839933`*^9, 3.711864653976039*^9}, {3.711864745544276*^9, 
   3.711864757352951*^9}, {3.711864812975133*^9, 3.7118648183364396`*^9}, 
   3.711865013197585*^9, 3.7118654166196594`*^9, {3.711865872832753*^9, 
   3.711865882607312*^9}, {3.7118659158322124`*^9, 3.7118659167752666`*^9}, 
   3.7118668815134463`*^9, 3.711877901179735*^9, {3.7118783158004503`*^9, 
   3.711878316543493*^9}, {3.7118783504884343`*^9, 3.7118783549436893`*^9}, {
   3.711884597723756*^9, 3.711884598723813*^9}, 3.71246906503905*^9, {
   3.7129871265354013`*^9, 3.71298712948657*^9}, 3.7129874538931246`*^9}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.7130723760899262`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ListPlot3D", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Re", "[", 
       RowBox[{"Fourier", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Re", "[", 
            RowBox[{"E1", "[", 
             RowBox[{"x", ",", "zstep"}], "]"}], "]"}], "/.", "s"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "0", ",", "xmax", ",", "0.05"}], "}"}]}], "]"}], 
        "]"}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"zstep", ",", "0", ",", "zmax", ",", "0.1"}], "}"}]}], "]"}], 
    ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "16"}], "}"}], ",", " ", "All", ",", "All"}], 
      "}"}]}], ",", " ", 
    RowBox[{"Ticks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", "50", ",", "2"}], "]"}], ",", 
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", "49", ",", "2"}], "]"}]}], "}"}], "]"}], ",", 
       " ", "Automatic", ",", " ", "Automatic"}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Full"}]}], "]"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.711432864154471*^9, 3.7114329264030313`*^9}, {
   3.711433009107762*^9, 3.7114332878967075`*^9}, {3.711433620240717*^9, 
   3.7114336813982143`*^9}, {3.7114345918962917`*^9, 3.711434600270771*^9}, {
   3.7114346744070115`*^9, 3.71143467927829*^9}, {3.7114347230627947`*^9, 
   3.7114347635581107`*^9}, {3.7114348251906357`*^9, 3.711434826821729*^9}, {
   3.7114349602773623`*^9, 3.711434972600067*^9}, {3.711435040947976*^9, 
   3.7114351006363907`*^9}, {3.7114353818754764`*^9, 
   3.7114354989381723`*^9}, {3.711435926990655*^9, 3.711435933558031*^9}, {
   3.7114370615835505`*^9, 3.711437078686528*^9}, {3.7117024509665003`*^9, 
   3.71170248295833*^9}, {3.7117039388366013`*^9, 3.711703940492696*^9}, {
   3.7117047175671425`*^9, 3.7117047976467223`*^9}, {3.7117049007906218`*^9, 
   3.711704903100754*^9}, {3.71170600746192*^9, 3.71170602075568*^9}, {
   3.711711087002453*^9, 3.711711094025855*^9}, {3.711711158857563*^9, 
   3.711711163248814*^9}, {3.711711219031005*^9, 3.711711226609438*^9}, {
   3.711714026682871*^9, 3.7117140436978445`*^9}, {3.7117141166740184`*^9, 
   3.7117141239004316`*^9}, {3.7117149185888853`*^9, 3.711714921508052*^9}, {
   3.7117163023230305`*^9, 3.711716310273485*^9}, {3.7117733158913155`*^9, 
   3.711773318402459*^9}, {3.7117737021284065`*^9, 3.711773779975859*^9}, {
   3.711773920397891*^9, 3.711773924837145*^9}, {3.7117740326783133`*^9, 
   3.711774049261262*^9}, {3.711777647972096*^9, 3.7117776804679546`*^9}, {
   3.7117778601232305`*^9, 3.7117778638344426`*^9}, {3.7117818762869415`*^9, 
   3.7117818766709633`*^9}, {3.7117819253427477`*^9, 
   3.7117819259347816`*^9}, {3.7117823484759493`*^9, 3.711782351763138*^9}, {
   3.7117938432979364`*^9, 3.711793858374799*^9}, {3.711793931447978*^9, 
   3.7117939778546324`*^9}, {3.7117941012456903`*^9, 3.711794150661516*^9}, {
   3.7117970829692345`*^9, 3.7117970868594575`*^9}, {3.712304271820334*^9, 
   3.71230427700463*^9}, {3.7123043152378173`*^9, 3.712304316261876*^9}, 
   3.7124679038356333`*^9, {3.712655906107565*^9, 3.712655906739601*^9}, 
   3.7129874014871273`*^9, 3.7129874507739463`*^9, {3.7129878790194407`*^9, 
   3.712987899359604*^9}, {3.712988112449792*^9, 3.712988118689149*^9}, 
   3.7129882804103985`*^9, {3.712988331239306*^9, 3.7129883806871347`*^9}, 
   3.713072162055684*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"DSolve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"d", " ", 
        RowBox[{
         RowBox[{"f", "'"}], "[", "z", "]"}]}], "==", " ", 
       RowBox[{
        RowBox[{"a", " ", 
         RowBox[{"f", "[", "z", "]"}]}], " ", "+", " ", 
        RowBox[{"b", " ", 
         RowBox[{"Exp", "[", 
          RowBox[{"h", " ", "z"}], "]"}]}]}]}], ",", 
      RowBox[{
       RowBox[{"f", "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}], ",", "f", 
    ",", " ", "z"}], "]"}], " "}]], "Input",
 CellChangeTimes->{{3.7129905760707035`*^9, 3.7129905854792414`*^9}, {
  3.7129906473097773`*^9, 3.7129906553022346`*^9}, {3.7129906887661486`*^9, 
  3.712990712669516*^9}, {3.7129907594291906`*^9, 3.7129908434529963`*^9}, {
  3.712991071557043*^9, 3.712991085995869*^9}, {3.712991125787145*^9, 
  3.712991160507131*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"f", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", "z", "}"}], ",", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"b", " ", 
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{"a", " ", "z"}], "d"]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["\[ExponentialE]", 
            FractionBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "a"}], "+", 
                RowBox[{"d", " ", "h"}]}], ")"}], " ", "z"}], "d"]]}], 
          ")"}]}], 
        RowBox[{"a", "-", 
         RowBox[{"d", " ", "h"}]}]]}]}], "]"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.712992793242518*^9}]
}, Open  ]]
},
WindowSize->{756, 858},
WindowMargins->{{Automatic, 230}, {Automatic, 14}},
FrontEndVersion->"10.4 for Microsoft Windows (64-bit) (April 11, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 16024, 339, 792, "Input"],
Cell[16607, 363, 6469, 88, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23113, 456, 2873, 47, 72, "Input"],
Cell[25989, 505, 79, 1, 31, "Output"]
}, Open  ]],
Cell[26083, 509, 3625, 70, 112, "Input"],
Cell[CellGroupData[{
Cell[29733, 583, 880, 23, 31, "Input"],
Cell[30616, 608, 838, 26, 66, "Output"]
}, Open  ]]
}
]
*)

